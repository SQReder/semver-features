import { Meta } from '@storybook/blocks';

<Meta title="API/Core" />

# Core API Reference

Complete API documentation for the `semver-features` core library.

## SemverFeatures

The main class for managing feature toggles.

### Constructor

```js
new SemverFeatures(options)
```

**Parameters:**

- `options` (Object):
  - `version` (String): Current application version (e.g., '1.2.3')
  - `defaultDisabledValue` (Any, optional): Default value to return when features are disabled
  - `logger` (Object, optional): Logger object with `log`, `warn`, and `error` methods

**Example:**

```js
const features = new SemverFeatures({
  version: '1.2.0',
  defaultDisabledValue: null,
  logger: console
});
```

### Methods

#### register()

Registers a new feature with version requirements.

```js
features.register(name, versionRequirement, options)
```

**Parameters:**

- `name` (String): Unique name for the feature
- `versionRequirement` (String): Minimum version required for the feature to be enabled
- `options` (Object, optional):
  - `defaultDisabledValue` (Any): Default value when disabled
  - `logger` (Object): Custom logger for this feature

**Returns:**

- `Feature`: A Feature instance

**Example:**

```js
const myFeature = features.register('my-feature', '1.1.0', {
  defaultDisabledValue: 'fallback'
});
```

#### registerWithEvaluator()

Registers a feature with a custom evaluator function.

```js
features.registerWithEvaluator(name, evaluator, options)
```

**Parameters:**

- `name` (String): Unique name for the feature
- `evaluator` (Function): Function that determines if the feature is enabled
  - Signature: `(version, featureName) => boolean`
- `options` (Object, optional): Same as `register()`

**Returns:**

- `Feature`: A Feature instance

**Example:**

```js
const customFeature = features.registerWithEvaluator(
  'custom-feature',
  (version, name) => {
    return version.startsWith('2.') && someExternalCondition();
  }
);
```

#### getVersion()

Gets the current version used by the feature manager.

```js
features.getVersion()
```

**Returns:**

- `String`: Current version string

#### setVersion()

Updates the version used by the feature manager.

```js
features.setVersion(newVersion)
```

**Parameters:**

- `newVersion` (String): New version to set

**Returns:**

- `void`

#### getFeature()

Gets a previously registered feature by name.

```js
features.getFeature(name)
```

**Parameters:**

- `name` (String): Feature name to lookup

**Returns:**

- `Feature | undefined`: The feature if found, undefined otherwise

## Feature

Represents a registered feature that can be checked for availability.

### Methods

#### isEnabled()

Checks if the feature is enabled.

```js
feature.isEnabled()
```

**Returns:**

- `Boolean`: `true` if enabled, `false` if disabled

#### getValue()

Gets the value based on feature status.

```js
feature.getValue(defaultValue)
```

**Parameters:**

- `defaultValue` (Any): Value to return if feature is disabled

**Returns:**

- Value if enabled, defaultValue if disabled

#### render()

Renders different content based on feature status.

```js
feature.render(options)
```

**Parameters:**

- `options` (Object):
  - `enabled` (Function): Function to call if feature is enabled
  - `disabled` (Function): Function to call if feature is disabled

**Returns:**

- Result of the enabled or disabled function

#### execute()

Executes different functions based on feature status.

```js
feature.execute(options)
```

**Parameters:**

- `options` (Object):
  - `enabled` (Function): Function to execute if feature is enabled
  - `disabled` (Function): Function to execute if feature is disabled

**Returns:**

- Result of the enabled or disabled function

#### map()

Maps to different values based on feature status.

```js
feature.map(options)
```

**Parameters:**

- `options` (Object):
  - `enabled` (Any): Value to return if feature is enabled
  - `disabled` (Any): Value to return if feature is disabled

**Returns:**

- The enabled or disabled value

#### fold()

Folds the feature to a value using transformation functions.

```js
feature.fold(enabledFn, disabledFn)
```

**Parameters:**

- `enabledFn` (Function): Function to call if feature is enabled
- `disabledFn` (Function): Function to call if feature is disabled

**Returns:**

- Result of the enabled or disabled function

## Utility Functions

### compose

Utilities for combining features with logical operations.

#### compose.and()

Creates a composite feature that is enabled only if all provided features are enabled.

```js
compose.and(features)
```

**Parameters:**

- `features` (Array of Feature): Array of features to check

**Returns:**

- `Feature`: A composite feature

#### compose.or()

Creates a composite feature that is enabled if any of the provided features are enabled.

```js
compose.or(features)
```

**Parameters:**

- `features` (Array of Feature): Array of features to check

**Returns:**

- `Feature`: A composite feature

#### compose.not()

Creates a composite feature that is enabled when the provided feature is disabled.

```js
compose.not(feature)
```

**Parameters:**

- `feature` (Feature): Feature to negate

**Returns:**

- `Feature`: A negated feature 