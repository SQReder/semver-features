import { Meta } from '@storybook/blocks';

<Meta title="API/React" />

# React API Reference

Complete API documentation for the `semver-features-react` library.

## Components

### FeatureToggle

A component that conditionally renders based on feature status.

```jsx
<FeatureToggle
  feature={featureInstance}
  enabled={enabledContent}
  disabled={disabledContent}
/>
```

**Props:**

- `feature` (Feature, required): A Feature instance from semver-features
- `enabled` (ReactNode, required): Content to render when feature is enabled
- `disabled` (ReactNode, required): Content to render when feature is disabled

**Example:**

```jsx
import { FeatureToggle } from 'semver-features-react';

function MyComponent() {
  return (
    <FeatureToggle
      feature={myFeature}
      enabled={<NewComponent />}
      disabled={<LegacyComponent />}
    />
  );
}
```

### FeatureEnabled

A component that only renders its children when a feature is enabled.

```jsx
<FeatureEnabled 
  feature={featureInstance}
>
  {children}
</FeatureEnabled>
```

**Props:**

- `feature` (Feature, required): A Feature instance from semver-features
- `children` (ReactNode, required): Content to render when feature is enabled

**Example:**

```jsx
import { FeatureEnabled } from 'semver-features-react';

function MyComponent() {
  return (
    <FeatureEnabled feature={myFeature}>
      <p>This content is only visible when the feature is enabled.</p>
      <NewComponent />
    </FeatureEnabled>
  );
}
```

### FeatureDisabled

A component that only renders its children when a feature is disabled.

```jsx
<FeatureDisabled 
  feature={featureInstance}
>
  {children}
</FeatureDisabled>
```

**Props:**

- `feature` (Feature, required): A Feature instance from semver-features
- `children` (ReactNode, required): Content to render when feature is disabled

**Example:**

```jsx
import { FeatureDisabled } from 'semver-features-react';

function MyComponent() {
  return (
    <FeatureDisabled feature={myFeature}>
      <p>This content is only visible when the feature is disabled.</p>
      <FallbackComponent />
    </FeatureDisabled>
  );
}
```

## Custom Hooks

While not included in the library, here are some useful custom hooks you can implement:

### useFeatureEnabled

A custom hook to check if a feature is enabled.

```jsx
function useFeatureEnabled(feature) {
  return feature.isEnabled();
}

// Usage
function MyComponent() {
  const isNewFeatureEnabled = useFeatureEnabled(newFeature);
  
  return (
    <div>
      {isNewFeatureEnabled ? (
        <p>New feature is enabled!</p>
      ) : (
        <p>New feature is disabled.</p>
      )}
    </div>
  );
}
```

### useFeatureValue

A custom hook to get a value based on feature status.

```jsx
function useFeatureValue(feature, defaultValue) {
  return feature.getValue(defaultValue);
}

// Usage
function MyComponent() {
  const config = useFeatureValue(configFeature, defaultConfig);
  
  return (
    <div>
      <p>Current config: {JSON.stringify(config)}</p>
    </div>
  );
}
```

## Integration Patterns

### With React Router

You can conditionally render routes based on feature status:

```jsx
import { Routes, Route, Navigate } from 'react-router-dom';
import { FeatureToggle } from 'semver-features-react';

function AppRoutes() {
  return (
    <Routes>
      <Route path="/" element={<Home />} />
      
      {/* Conditionally rendered route */}
      <Route
        path="/new-feature"
        element={
          <FeatureToggle
            feature={newFeatureRoute}
            enabled={<NewFeaturePage />}
            disabled={<Navigate to="/feature-unavailable" />}
          />
        }
      />
      
      <Route path="/feature-unavailable" element={<FeatureUnavailablePage />} />
    </Routes>
  );
}
```

### With Suspense and Lazy Loading

You can conditionally load components based on feature status:

```jsx
import React, { Suspense, lazy } from 'react';
import { FeatureToggle } from 'semver-features-react';

// Lazy-loaded components
const NewComponent = lazy(() => import('./NewComponent'));
const LegacyComponent = lazy(() => import('./LegacyComponent'));

function MyComponent() {
  return (
    <Suspense fallback={<div>Loading...</div>}>
      <FeatureToggle
        feature={newUIFeature}
        enabled={<NewComponent />}
        disabled={<LegacyComponent />}
      />
    </Suspense>
  );
}
```

### With Context API

You can provide features through React Context:

```jsx
import React, { createContext, useContext } from 'react';

// Create context
const FeaturesContext = createContext(null);

// Provider component
export function FeaturesProvider({ children, features }) {
  return (
    <FeaturesContext.Provider value={features}>
      {children}
    </FeaturesContext.Provider>
  );
}

// Custom hook to access features
export function useFeatures() {
  const context = useContext(FeaturesContext);
  if (!context) {
    throw new Error('useFeatures must be used within a FeaturesProvider');
  }
  return context;
}

// Usage
function App() {
  // Setup features
  const features = {
    newFeature: featureManager.register('new-feature', '1.2.0'),
    // ...more features
  };
  
  return (
    <FeaturesProvider features={features}>
      <YourApplication />
    </FeaturesProvider>
  );
}

// In a component
function FeatureAwareComponent() {
  const features = useFeatures();
  
  return (
    <FeatureToggle
      feature={features.newFeature}
      enabled={<NewUI />}
      disabled={<OldUI />}
    />
  );
}
``` 